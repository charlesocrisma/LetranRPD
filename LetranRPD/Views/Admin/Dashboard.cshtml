@{
	ViewBag.Title = "Admin Dashboard";
	Layout = "~/Views/Shared/_AdminNav.cshtml";
}
<link href="/css/admin/dashboard.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="layout">
	<div class="content">
		<div id="dashboard" class="module-page active">
			<div class="module-header">
				<h2 class="module-title">Dashboard Overview</h2>
			</div>

			<!-- Stats Grid -->
			<div class="stats-grid">
				<div class="stat-card">
					<div class="stat-header">
						<div class="stat-title">Total Students</div>
						<div class="stat-icon" style="background: rgba(102, 126, 234, 0.1); color: #667eea;">👨‍🎓</div>
					</div>
					<div class="stat-value">1,247</div>
					<div class="stat-change positive">↗ +12% from last month</div>
				</div>

				<div class="stat-card">
					<div class="stat-header">
						<div class="stat-title">Active Researches</div>
						<div class="stat-icon" style="background: rgba(56, 161, 105, 0.1); color: #38a169;">📝</div>
					</div>
					<div class="stat-value">89</div>
					<div class="stat-change positive">↗ +8% from last week</div>
				</div>

				<div class="stat-card">
					<div class="stat-header">
						<div class="stat-title">Pending Reviews</div>
						<div class="stat-icon" style="background: rgba(237, 137, 54, 0.1); color: #ed8936;">⏳</div>
					</div>
					<div class="stat-value">23</div>
					<div class="stat-change negative">↘ -5% from yesterday</div>
				</div>

				<div class="stat-card">
					<div class="stat-header">
						<div class="stat-title">Certificates Issued</div>
						<div class="stat-icon" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">🏆</div>
					</div>
					<div class="stat-value">456</div>
					<div class="stat-change positive">↗ +15% this month</div>
				</div>
			</div>

			<!-- Chart Section -->
			<div class="chart-section">
				<div class="chart-header">
					<h3 class="chart-title">Most Used Services</h3>
					<div class="chart-filters">
						<button class="filter-btn active" onclick="filterChart('month')">Month</button>
						<button class="filter-btn" onclick="filterChart('semester')">Semester</button>
						<button class="filter-btn" onclick="filterChart('year')">Year</button>
					</div>
				</div>

				<div class="chart-container">
					<canvas id="servicesChart"></canvas>
				</div>

				<div class="chart-legend">
					<div class="legend-items">
						<div class="legend-item">
							<div class="legend-color" style="background: #667eea;"></div>
							<span>Originality Check</span>
							<span class="legend-value" id="originalitycheck">342</span>
						</div>
						<div class="legend-item">
							<div class="legend-color" style="background: #38a169;"></div>
							<span>Instrument Validation</span>
							<span class="legend-value" id="instrumentvalidation">156</span>
						</div>
						<div class="legend-item">
							<div class="legend-color" style="background: #ed8936;"></div>
							<span>Language Editing</span>
							<span class="legend-value" id="languageediting">89</span>
						</div>
						<div class="legend-item">
							<div class="legend-color" style="background: #e53e3e;"></div>
							<span>Data Analysis</span>
							<span class="legend-value" id="dataanalysis">67</span>
						</div>
						<div class="legend-item">
							<div class="legend-color" style="background: #8b5cf6;"></div>
							<span>Student Research Clearance</span>
							<span class="legend-value" id="srudentresearchclearance">134</span>
						</div>
						<div class="legend-item">
							<div class="legend-color" style="background: #f56565;"></div>
							<span>Ethics Review</span>
							<span class="legend-value" id="ethicsreview">78</span>
						</div>
					</div>
				</div>
			</div>

			<!-- Recent Activity -->
			<div style="background: white; padding: 2rem; border-radius: 16px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05); margin-top: 2rem;">
				<h3 style="margin-bottom: 1rem; color: #2d3748;">Recent Activity</h3>
				<div class="activity-list">
					<div class="activity-item">
						<div class="activity-icon">📝</div>
						<div class="activity-content">
							<div class="activity-title">New research submission</div>
							<div class="activity-time">2 hours ago</div>
						</div>
					</div>
					<div class="activity-item">
						<div class="activity-icon">✅</div>
						<div class="activity-content">
							<div class="activity-title">Certificate approved</div>
							<div class="activity-time">4 hours ago</div>
						</div>
					</div>
					<div class="activity-item">
						<div class="activity-icon">💬</div>
						<div class="activity-content">
							<div class="activity-title">Admin comment added</div>
							<div class="activity-time">6 hours ago</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


<script>
	let servicesChart;

	// Data for each service across months, semesters, and years
	const chartData = {
		"Originality Check": {
			month: [342, 345, 380, 400, 350, 320, 310, 300, 330, 320, 350, 340],  // example month data
			semester: [600, 700],  // 1st Sem, 2nd Sem
			year: [1890, 2000, 2500]  // example year data
		},
		"Instrument Validation": {
			month: [156, 160, 170, 180, 150, 140, 130, 125, 135, 140, 150, 155],
			semester: [300, 350],
			year: [1200, 1300, 1400]
		},
		"Language Editing": {
			month: [89, 95, 105, 110, 90, 85, 95, 100, 110, 120, 125, 130],
			semester: [200, 250],
			year: [950, 1000, 1100]
		},
		"Data Analysis": {
			month: [67, 70, 72, 80, 75, 74, 68, 65, 70, 80, 85, 90],
			semester: [150, 200],
			year: [700, 750, 800]
		},
		"Research Clearance": {
			month: [134, 140, 150, 160, 150, 145, 130, 120, 135, 140, 150, 160],
			semester: [300, 350],
			year: [900, 950, 1000]
		},
		"Ethics Review": {
			month: [78, 85, 90, 95, 80, 75, 70, 85, 95, 100, 105, 110],
			semester: [170, 200],
			year: [600, 650, 700]
		}
	};

	// Function to render the chart based on the selected period (Month, Semester, Year)
	function renderChart(period) {
		const ctx = document.getElementById('servicesChart').getContext('2d');

		// Destroy the previous chart before rendering a new one
		if (servicesChart) {
			servicesChart.destroy();
		}

		// Prepare data for the selected period (Month, Semester, Year)
		const periods = period === 'month' ? ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
						: period === 'semester' ? ['1st Sem', '2nd Sem']
						: ['2020', '2021', '2022'];  // Years

		// Prepare datasets for each service
		const datasets = Object.keys(chartData).map((service, i) => ({
			label: service,
			data: chartData[service][period],
			borderColor: [
				"#667eea", "#38a169", "#ed8936", "#e53e3e", "#8b5cf6", "#f56565"
			][i],
			backgroundColor: "transparent",
			borderWidth: 2,
			fill: false,
			tension: 0.3,
			pointRadius: 5,
			pointHoverRadius: 7
		}));

		// Create the chart
		servicesChart = new Chart(ctx, {
			type: 'line',
			data: {
				labels: periods,  // Dynamically set based on the period
				datasets: datasets
			},
			options: {
				responsive: true,
				maintainAspectRatio: false,
				plugins: {
					legend: { display: true, position: 'bottom' }
				},
				scales: {
					y: {
						beginAtZero: true,
						title: { display: true, text: "Number of Availed Services" }
					},
					x: {
						title: { display: true, text: period === 'month' ? "Month" : period === 'semester' ? "Semester" : "Year" }
					}
				}
			}
		});
	}

	// Filter function to switch between Month, Semester, and Year
	function filterChart(period) {
		// Update chart with the selected period's data
		renderChart(period);

		// Mark the active filter button
		document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
		event.target.classList.add('active');
	}

	// Initial chart render on page load (default to Month)
	document.addEventListener("DOMContentLoaded", () => {
		renderChart('month');
	});
</script>


